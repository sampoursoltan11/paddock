# SmartProof AI - Where to Configure Everything

Quick reference guide showing exactly where each configuration value goes.

---

## üéØ Quick Start Process

### 1. Run Provisioning Script
```bash
./scripts/provision-azure-resources.sh dev
```
This creates `config-dev.txt` with all values you need.

### 2. Copy Values to Two Files

#### File #1: `backend/local.settings.json`
#### File #2: `frontend/.env`

---

## üìã Backend Configuration

**File:** `backend/local.settings.json`

| Setting | Source | Where to Get It |
|---------|--------|-----------------|
| `AzureWebJobsStorage` | config-dev.txt | Line: `AZURE_STORAGE_CONNECTION_STRING` |
| `AZURE_STORAGE_CONNECTION_STRING` | config-dev.txt | Line: `AZURE_STORAGE_CONNECTION_STRING` |
| `AZURE_STORAGE_ACCOUNT_NAME` | config-dev.txt | Line: `STORAGE_ACCOUNT_NAME` |
| `AZURE_OPENAI_ENDPOINT` | config-dev.txt | Line: `AZURE_OPENAI_ENDPOINT` |
| `AZURE_OPENAI_KEY` | config-dev.txt | Line: `AZURE_OPENAI_KEY` |
| `AZURE_AI_SEARCH_ENDPOINT` | config-dev.txt | Line: `AZURE_AI_SEARCH_ENDPOINT` |
| `AZURE_AI_SEARCH_KEY` | config-dev.txt | Line: `AZURE_AI_SEARCH_KEY` |
| `AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT` | config-dev.txt | Line: `AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT` |
| `AZURE_DOCUMENT_INTELLIGENCE_KEY` | config-dev.txt | Line: `AZURE_DOCUMENT_INTELLIGENCE_KEY` |
| `AZURE_COMPUTER_VISION_ENDPOINT` | config-dev.txt | Line: `AZURE_COMPUTER_VISION_ENDPOINT` |
| `AZURE_COMPUTER_VISION_KEY` | config-dev.txt | Line: `AZURE_COMPUTER_VISION_KEY` |

### Complete Backend Template

```json
{
  "IsEncrypted": false,
  "Values": {
    "AzureWebJobsStorage": "DefaultEndpointsProtocol=https;AccountName=...",
    "FUNCTIONS_WORKER_RUNTIME": "node",

    "AZURE_STORAGE_CONNECTION_STRING": "DefaultEndpointsProtocol=https;AccountName=...",
    "AZURE_STORAGE_ACCOUNT_NAME": "smartproofstordev",

    "AZURE_OPENAI_ENDPOINT": "https://smartproof-openai-dev.openai.azure.com/",
    "AZURE_OPENAI_KEY": "your-key-here",
    "AZURE_OPENAI_DEPLOYMENT_GPT4": "gpt-4",
    "AZURE_OPENAI_DEPLOYMENT_GPT4_VISION": "gpt-4-vision",

    "AZURE_AI_SEARCH_ENDPOINT": "https://smartproof-search-dev.search.windows.net",
    "AZURE_AI_SEARCH_KEY": "your-key-here",
    "AZURE_AI_SEARCH_INDEX_NAME": "smartproof-product-info",

    "AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT": "https://smartproof-docintel-dev.cognitiveservices.azure.com/",
    "AZURE_DOCUMENT_INTELLIGENCE_KEY": "your-key-here",

    "AZURE_COMPUTER_VISION_ENDPOINT": "https://smartproof-vision-dev.cognitiveservices.azure.com/",
    "AZURE_COMPUTER_VISION_KEY": "your-key-here",

    "BLOB_CONTAINER_UPLOADS": "uploads",
    "BLOB_CONTAINER_PROCESSED": "processed",
    "BLOB_CONTAINER_REPORTS": "reports",
    "BLOB_CONTAINER_STATE": "state",

    "LOG_LEVEL": "info",
    "ENVIRONMENT": "development"
  }
}
```

---

## üé® Frontend Configuration

**File:** `frontend/.env`

| Setting | Source | Where to Get It |
|---------|--------|-----------------|
| `VITE_AZURE_AD_CLIENT_ID` | Azure Portal or provisioning script output | Azure AD App Registration ‚Üí Overview ‚Üí Application (client) ID |
| `VITE_AZURE_AD_TENANT_ID` | Azure Portal or provisioning script output | Azure AD App Registration ‚Üí Overview ‚Üí Directory (tenant) ID |
| `VITE_AZURE_AD_REDIRECT_URI` | Manual | `http://localhost:3000` (for local) |
| `VITE_API_BASE_URL` | Manual | `http://localhost:7071/api` (for local) |

### Complete Frontend Template

```env
# Azure AD Configuration
VITE_AZURE_AD_CLIENT_ID=12345678-1234-1234-1234-123456789abc
VITE_AZURE_AD_TENANT_ID=87654321-4321-4321-4321-cba987654321
VITE_AZURE_AD_REDIRECT_URI=http://localhost:3000

# API Configuration
VITE_API_BASE_URL=http://localhost:7071/api

# Environment
VITE_ENVIRONMENT=development
```

---

## üîê Azure AD App Registration

**Where:** Azure Portal ‚Üí Azure Active Directory ‚Üí App registrations

### If Created by Provisioning Script:
- Script will output the Client ID and Tenant ID
- Copy these to `frontend/.env`

### If Creating Manually:

1. **Create App Registration**
   - Portal ‚Üí Azure Active Directory ‚Üí App registrations ‚Üí New registration
   - Name: `smartproof-dev`
   - Supported accounts: Single tenant
   - Register

2. **Get Client ID and Tenant ID**
   - Go to Overview tab
   - Copy **Application (client) ID** ‚Üí `VITE_AZURE_AD_CLIENT_ID`
   - Copy **Directory (tenant) ID** ‚Üí `VITE_AZURE_AD_TENANT_ID`

3. **Configure Redirect URIs**
   - Authentication ‚Üí Add a platform ‚Üí Single-page application
   - Add: `http://localhost:3000`
   - Add: `https://smartproof-web-dev.azurewebsites.net` (for Azure deployment)
   - Enable ID tokens
   - Save

---

## üóÇÔ∏è File Locations Summary

```
smartproof-poc/
‚îú‚îÄ‚îÄ config-dev.txt                    # Generated by provisioning script - SOURCE OF TRUTH
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ .env.example                  # Template (don't edit)
‚îÇ   ‚îî‚îÄ‚îÄ .env                          # ‚Üê EDIT THIS (copy from .env.example)
‚îÇ
‚îî‚îÄ‚îÄ backend/
    ‚îú‚îÄ‚îÄ local.settings.json.example   # Template (don't edit)
    ‚îî‚îÄ‚îÄ local.settings.json           # ‚Üê EDIT THIS (copy from .example)
```

---

## üîÑ Configuration Workflow

```
1. Run provisioning script
   ‚Üì
2. Script creates config-dev.txt
   ‚Üì
3. Copy values from config-dev.txt ‚Üí backend/local.settings.json
   ‚Üì
4. Get Azure AD IDs (from script output or Azure Portal)
   ‚Üì
5. Add Azure AD IDs ‚Üí frontend/.env
   ‚Üì
6. Done! Start development servers
```

---

## üìù Step-by-Step Copy-Paste Guide

### Step 1: Open Files Side-by-Side

```bash
# Terminal 1
cat config-dev.txt

# Terminal 2
code backend/local.settings.json

# Terminal 3
code frontend/.env
```

### Step 2: Backend - Copy These Lines

From `config-dev.txt`, copy:
- `AZURE_STORAGE_CONNECTION_STRING=...` ‚Üí `AzureWebJobsStorage` AND `AZURE_STORAGE_CONNECTION_STRING`
- `STORAGE_ACCOUNT_NAME=...` ‚Üí `AZURE_STORAGE_ACCOUNT_NAME`
- `AZURE_OPENAI_ENDPOINT=...` ‚Üí `AZURE_OPENAI_ENDPOINT`
- `AZURE_OPENAI_KEY=...` ‚Üí `AZURE_OPENAI_KEY`
- `AZURE_AI_SEARCH_ENDPOINT=...` ‚Üí `AZURE_AI_SEARCH_ENDPOINT`
- `AZURE_AI_SEARCH_KEY=...` ‚Üí `AZURE_AI_SEARCH_KEY`
- `AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT=...` ‚Üí `AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT`
- `AZURE_DOCUMENT_INTELLIGENCE_KEY=...` ‚Üí `AZURE_DOCUMENT_INTELLIGENCE_KEY`
- `AZURE_COMPUTER_VISION_ENDPOINT=...` ‚Üí `AZURE_COMPUTER_VISION_ENDPOINT`
- `AZURE_COMPUTER_VISION_KEY=...` ‚Üí `AZURE_COMPUTER_VISION_KEY`

### Step 3: Frontend - Add Azure AD

From provisioning script output or Azure Portal:
- Application (client) ID ‚Üí `VITE_AZURE_AD_CLIENT_ID`
- Directory (tenant) ID ‚Üí `VITE_AZURE_AD_TENANT_ID`

Keep these as-is:
- `VITE_AZURE_AD_REDIRECT_URI=http://localhost:3000`
- `VITE_API_BASE_URL=http://localhost:7071/api`

### Step 4: Verify

```bash
# Check backend config has values (no "your-key-here" placeholders)
cat backend/local.settings.json | grep "your-key-here"
# Should return nothing

# Check frontend config has Azure AD values
cat frontend/.env | grep "VITE_AZURE_AD"
# Should show your client ID and tenant ID
```

---

## üö® Common Mistakes

### ‚ùå Mistake 1: Using example files directly
**Wrong:** Editing `.env.example` or `local.settings.json.example`
**Right:** Copy to `.env` and `local.settings.json`, then edit

### ‚ùå Mistake 2: Forgetting to save after editing
**Wrong:** Editing file but not saving (Ctrl+S)
**Right:** Always save after editing configuration files

### ‚ùå Mistake 3: Using wrong connection string
**Wrong:** Using storage account name instead of full connection string
**Right:** Use complete connection string: `DefaultEndpointsProtocol=https;AccountName=...`

### ‚ùå Mistake 4: Mismatched redirect URI
**Wrong:** `http://localhost:3000/` (with trailing slash)
**Right:** `http://localhost:3000` (no trailing slash)

### ‚ùå Mistake 5: Not restarting servers after config change
**Wrong:** Changing config while servers are running
**Right:** Stop servers (Ctrl+C), change config, restart servers

---

## ‚úÖ Verification Checklist

Before starting development, verify:

- [ ] `config-dev.txt` exists and has values
- [ ] `backend/local.settings.json` exists (not .example)
- [ ] `backend/local.settings.json` has all Azure connection strings
- [ ] `backend/local.settings.json` has no "your-key-here" placeholders
- [ ] `frontend/.env` exists (not .example)
- [ ] `frontend/.env` has Azure AD client ID
- [ ] `frontend/.env` has Azure AD tenant ID
- [ ] Azure AD app registration has redirect URI: `http://localhost:3000`
- [ ] Both files are saved

---

## üîç How to Get Values Later

If you need to retrieve values again:

### Storage Connection String
```bash
az storage account show-connection-string \
  --name smartproofstordev \
  --resource-group smartproof-rg-dev
```

### AI Search Key
```bash
az search admin-key show \
  --service-name smartproof-search-dev \
  --resource-group smartproof-rg-dev
```

### Cognitive Services Keys
```bash
# Document Intelligence
az cognitiveservices account keys list \
  --name smartproof-docintel-dev \
  --resource-group smartproof-rg-dev

# Computer Vision
az cognitiveservices account keys list \
  --name smartproof-vision-dev \
  --resource-group smartproof-rg-dev

# Azure OpenAI
az cognitiveservices account keys list \
  --name smartproof-openai-dev \
  --resource-group smartproof-rg-dev
```

### Azure AD Information
```bash
# Tenant ID
az account show --query tenantId -o tsv

# List app registrations
az ad app list --display-name smartproof-dev
```

---

## üìû Quick Help

**Can't find config-dev.txt?**
‚Üí Run `./scripts/provision-azure-resources.sh dev` again

**Azure AD client ID not working?**
‚Üí Check Azure Portal ‚Üí Azure Active Directory ‚Üí App registrations ‚Üí smartproof-dev ‚Üí Overview

**Backend can't connect to Azure?**
‚Üí Verify keys in `local.settings.json` match Azure Portal

**CORS errors in frontend?**
‚Üí Check `VITE_API_BASE_URL` is `http://localhost:7071/api`

---

## üìö Related Documentation

- **[LOCAL_DEVELOPMENT_GUIDE.md](docs/LOCAL_DEVELOPMENT_GUIDE.md)** - Complete setup walkthrough
- **[CONFIGURATION_GUIDE.md](docs/CONFIGURATION_GUIDE.md)** - Detailed configuration reference
- **[QUICKSTART.md](QUICKSTART.md)** - Quick reference guide

---

**Last Updated:** 2025-10-23
**Version:** 1.0.0
